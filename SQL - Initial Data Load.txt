//exit Script;   //before loading data, place "//" in front of the "exit" word of this line. Load data using this script before moving onto the incremental load script.

//Insert your OLE DB Omnicell server connection here. 

Query:
SQL

select 
xact.xact_key AS TransactionID
,xact.xact_dati AS TransactionDateNBR
,xact.xfer_type AS TransferTypeCD
,xact.null_type AS NullTypeCD
,xact.qty AS ChargeQuantityNBR
,xact.qty_onhand AS OnHandQuantityNBR
,xact.waste_qty AS WasteAmountTXT
,xact.qty_req AS RequisitionNBR
,xact.bill_dati AS TransactionBilledDTS
,xact.countback AS CountBackFLG
,xact.issuedisch AS IssueToDischargePatientAllowedFLG
,xact.mooverride AS MedicationOrderOverrideFLG
,xact.medb_act AS MedicationBTransactionFromSupplierFLG
,xact.tpat_recon AS TempPatientReconciliationStatusCD
,xact.rtnreason AS ReasonForReturningItemCD
,xact.xact_misc AS TransactionMiscellaneousNM
,xact.xact_misc2 AS TransactionMiscellaneous2NM
,xact.dati_misc AS MiscellaneousDateNBR
,xact.dose AS DoseAmountNBR
,xact.ia_dose AS IntendedActualDoseNBR
,xact.lomni_stid AS LinkedOmniSupplierNM
,xact.dose_xa AS DoseTransactionFLG
,xact.lu_dati AS LastUpdatedEntryDateNBR
,xact.lu_from AS LastUpdatedLocationNM
,xact.area_key AS InternalAreaID
,xact.cost_key AS InternalCostCenterID
,xact.drg_key AS InternalDRGID
,xact.icd9_key AS ICD9CodeID
,xact.item_key AS InternalItemID
,xact.med_key AS InternalMedicationID
,xact.omni_key AS InternalOmniID
,xact.pat_key AS InternalPatientKeyID
,xact.site_key AS InternalSiteID
,xact.user_key AS InternalUserID
,xact.witn_key AS InternalWitnessID
,xact.xcase_key AS XCaseID
,xact.xkit_key AS XKitID
,xact.xpref_key AS XPrefID
,xact.xmor_key AS XMorID
,xact.xmas_key AS XMasID
,xact.retry_cnt AS RetryCountNBR
,xact.loginposid AS LoginPositiveID
,xact.xiscan_key AS XIscanID
,xact.iscantype AS ItemScanTypeCD
,xact.iscanover AS ItemScanOverrideCD
,xact.pcr_dati AS PostCaseReconciliationTransactionDateNBR
,xact.al_alert AS AllergyAlertCD
,xact.xmisc_key AS XMiscellaneousID
,xact.qty_total AS QuantityTotalNBR
,xact.modue_dati AS MedicationOrderScheduleDateNBR
,xact.dispalert AS DispensingAlertTransactionCD
,xact.xact_link AS XATransactionLinkID
,xact.xbed_key AS XBedID
,xact.xnote_key AS XNoteID
,xact.psb_bin AS PSBBinID
,xact.qty_order AS OrderQuantityNBR
,xact.moitype AS MedicationOrderTypeCD
,xact.xamoitemid AS TransactionOrderComponentCD
,xact.modisptype AS MedicationOrderDueTypeCD
,xact.xfersub AS TransactionSubTypeCD
,xact.qty_psb AS TotalPSBQuantityNBR
,xact.mi_dati AS MyItemsAccountOpenedDateNBR
,xact.pm_dati AS PMAccountOpenedDateNBR
,xact.multibinxa AS MultipleXAGeneratedSingleUserEventTypeCD
,xact.ia_total AS IntendedTotalAdministrationCD
,xact.rq_dati AS RemoteRequestDateNBR
,xact.ia_commit AS CommitPriorTransactionsCD
,xact.ia_admin AS IntendedCommitedDoseAdministrationCD
,xact.xa_amt AS TransactionAmountNBR
,xact.proc_dati AS DTTransactionServerProcessedDateNBR
,xact.pm_user AS UserAccountTransactionCD
,xact.iss_cancld AS IssueCancelledCD
,xact.rq_key AS RemoteRequestCD
,xact.mi_user AS MyItemsUserCD
,xact.pcr_id AS PCRIdentificationID
,xact.multi_item AS MultipleItemCD
,xact.pcr_type AS PCRTypeCD
,xact.pc_legacy AS PCRLegacyAccountCD
,xact.xact_seq AS AdministrationTransactionSeqCD
,xact.xrest_key AS XRestockCD
,xact.rest_part AS LineItemPartiallyStockedCD
,xact.bexp_dati AS ExpirationDateNBR
,xact.vlt_proc AS CSMCabinetTransactionGroupNM
,xact.vlt_dati AS CSMCabinetTransactionDateNBR
,xact.rtnbinxa AS ItemPlacedInReturnBinCD
,xact.eib_xa AS ExpiredItemBinTransactionCD
,xact.srce_code AS TransactionSourceCD
,xact.srce_site AS SourceSiteCD
,xact.srce_area AS SourceAreaCD
,xact.srce_omni AS SourceOmniCD
,xact.adjust_xa AS AdjustmentToOriginalTransactionCD
,xact.qty_inv AS InventoryBinsQuantityNBR
,xact.xinv_key AS XInventoryCD
,xact.uf_id AS UsageFormTrackingCD
,xact.uf_doses AS MaxLinesOnUsageFormCD
,xact.loop_hint AS CSMPicksExpectedAccountabilityMethodCD
,xact.xe_src AS ExternalSystemSourceTransactionCD
,xact.xe_id AS ExternalSystemTransactionID
,xact.xe_origid AS ExternalSystemOriginalTransactionID
,xact.lu_user AS LastUpdatedIdentifierCD
,xact.time_stamp as TransactionTimeStampDTS
,cast(xact.time_stamp as date) as DateDT
,xact.xact_utc AS UTCTransactionDateNBR
,xact.batch_no AS ItemLotNumberCD
,xact.batch_audit_req AS ItemBatchLotAuditRequiredCD
,xact.batchqoh AS BatchLotOnHandQuantityAmountNBR
,xact.batch_assume AS AssumedBatchNumberCD
,xact.xe_parentid AS ExternalSystemParentIdentificationCD
,xact.admin_dose AS AdministrationDoseAmountNBR
,xact.admin_unit AS AdministrationUnitCD
,xact.is_archived AS IsArchivedCD
,xact.change_detection_type AS ChangeDetectionTypeCD
,xact.dispense_id AS DispenseTransactionID
,xact.xar_source AS XARSourceCD
,xuser.xact_dati AS UserDateNBR
,xuser.user_id AS UserID
,xuser.user_name AS UserNM
,xuser.user_type AS UserTypeNM
,xuser.user_inits AS UserInitialsNM
,xuser.pro_title AS ProfessionalTitleNM
,xuser.time_stamp AS UserTimeStampDTS
,xuser.intop_uid AS PartnerSystemUserID
,xuser.domain_user AS DomainUserNM
,xuser.ad_exempt AS ActiveDirectoryExemptionCD
,xuser.domain AS DomainID
,xitem.xact_dati AS ItemDateNBR
,xitem.item_id AS OmniSupplierItemID
,xitem.omni_bin AS OmniBinID
,xitem.item_name AS MedicationNM
,xitem.rx_name AS MedicationLongNM
,xitem.chg_id AS ChargeID
,xitem.chg_type AS ChargeTypeCD
,xitem.qty_parlvl AS ParLevelQuantityNBR
,xitem.unit_issue AS UnitOfMeasureCD
,xitem.unit_cost AS UnitCostNBR
,xitem.unit_price AS UnitPriceAmountNBR
,xitem.item_misc1 AS ItemMiscellaneous1NBR
,xitem.item_misc2 AS ItemMiscellaneous2NBR
,xitem.item_misc3 AS ItemMiscellaneous3NBR
,xitem.uses_sn AS RecordLotFLG
,xitem.unit_stock AS RestockingUnitCD
,xitem.conv_stkis AS IssueUnitsInOneStockingUnitNBR
,xitem.min_source AS NormalReorderSourceD
,xitem.alm_source AS EmergencyReorderSourceCD
,xitem.ctrl_lvl AS ItemAccessControlLevelNBR
,xitem.dos_str AS StrengthAmountNBR
,xitem.dos_amt AS DosageVolumeAmountNBR
,xitem.dos_units AS DosageVolumeUnitsCD
,xitem.dos_form AS DosageFormCD
,xitem.str_units AS StrengthUnitsCD
,xitem.tvol_units AS TotalVolumeUnitsCD
,xitem.tvol_amt AS TotalVolumeAmountNBR
,xitem.mfr_num AS ManufacturerPartNumberTXT
,xitem.mfr_name AS ManufacturerNM
,xitem.medb_item AS MedicationBItemCD
,xitem.category AS CategoryCD
,xitem.multidose AS MultipleDoseCD
,xitem.norm_flag AS StandardizationFLG
,xitem.rx_suffix AS PharmacyItemDosageDSC
,xitem.ss_restock AS SafetyStockConfirmationRestockCD
,xitem.ss_issue AS SafetyStockConfirmationIssueCD
,xitem.binconf AS BinConfirmationID
,xitem.pkg_dose AS SingleIssuePackageDoseNBR
,xitem.stock_type AS StockTypeCD
,xitem.consign AS ConsignmentItemNBR
,xitem.latex_wrn AS LatexWarningCD
,xitem.pat_med AS PatientsOwnMedicationCD
,xitem.multi_use AS MultipleUseCD
,xitem.ig_code AS ItemGroupCD
,xitem.multi_day AS MultipleDayAdministrationItemFLG
,xitem.recon_dose AS DoseReconciliationFLG
,xitem.item_alias AS ItemAliasDSC
,xitem.nurse_mix AS MultipleComponentMedicationOrderMixFLG
,xitem.is_mix AS MultipleComponentMixtureOrderFLG
,xitem.ord_round AS RoundedNormalRestockAmountNBR
,xitem.time_stamp AS ItemTimeStampDTS
,xitem.draw_type AS DrawerTypeCD
,xitem.batch_track AS BatchTrackNBR
,xitem.qty_min AS MinimumQuantityNBR
,xitem.loc_description AS LocationDSC
,xitem.isb_ct AS AssignedSingleItemBinNBR
,xitem.psb_ct AS AssignedPatientSpecificBinNBR
,xitem.unknown_item AS UnknownItemNBR
,xitem.synonym_id AS SynonymIdentificationDSC
,xitem.act_vendor_item_id AS ActiveVendorItemIdentificationDSC
,xitem.act_vend_id AS ActiveVendorIdentificationDSC
,xitem.device_type AS DeviceTypeCD
,xitem.site_id AS SiteID
,xomni.xact_dati AS OmniDateNBR
,xomni.omni_stid AS OmniSiteID
,xomni.omni_name AS OmniNM
,xomni.omni_type AS OmniTypeCD
,xomni.time_stamp AS OmniTimeStampDTS
,xomni.omni_platform AS OmniPlatformCD
,xomni.site_id AS LocationID
,omnis.area as AreaCD
,omnis.omni_stat as CurrentStatusCD
,omnis.comm_ip as IPAddressNM
,omnis.iscabinet as IsCabinetAttachedFLG
,omnis.omni_id as OmniSiteShortNM

FROM  xact
      left join  xitem
       ON xitem.item_key = xact.item_key
       left JOIN xomni
       on xomni.omni_key = xact.omni_key
       left JOIN xuser
       ON xuser.user_key = xact.user_key
       left join omnis
       on omnis.omni_stid = xomni.omni_stid
           
       ;
       
/*Store the Query table into a QVD file to be read by the incremental load.  
Add the folder connection string below by changing the TCH script to match the name of your folder connection and desired file name 
Syntax: 'lib://FolderConnectionName/FileName.qvd'
*/
STORE Query INTO 'lib://FolderConnection/Omnicell.qvd' (qvd);

//Exit script so this initial load does not continue onto the incremental load script.
exit script;